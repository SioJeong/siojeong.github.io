---
title: 새로고침해도 로그인을 유지하는 방법
date: 2024-10-15
tag: [Web, React]
---


## Intro

프로젝트를 하다보면 진행 상황을 저장하거나, 로그인 정보를 저장하는 등 브라우저를 껐다 키거나, 새로고침을 하더라도 데이터가 남아있어야 하는 상황이 자주 발생한다.  

이럴 때는 **Local Storage**나 **Session Storage**를 활용해서 구현하는데    
Local Storage는 새로고침 및 브라우저를 닫은 후에도 데이터가 유지되며,  
Session Storage는 새로고침 상황에서만 유지될 수 있게 해준다.  

이번 글은 상태 관리 라이브러리인 Rrecoil-persist를 사용해서 새로고침을 해도 로그인을 유지할 수 있도록 access-token과 refresh-token을 관리해보곘다.   

## 1. Recoil과 recoil-persist

### 1.1 recoil-persist란

**recoil-persist**는 Recoil 상태를 로컬 스토리지나 세션 스토리지에 저장하여, 상태를 유지할 수 있게 해주는 라이브러리다.  

### 1.2 라이브러리 설치

```bash
npm install recoil recoil-persist
```

### 1.3 기본 설정

- **key**: 저장소에 저장될 key 값
- **storage**: 저장소 선택 (localStorage or sessionStorage)

```typescript
useAuthStore.ts
import { atom } from "recoil";
import { recoilPersist } from "recoil-persist";

// recoil-persist 설정
const { persistAtom } = recoilPersist({
    key: "recoil-persist",
    storage: sessionStorage,
});
```

기본 설정 이후 로컬 혹은 세션 스토리지에 저장하고 싶은 atom에 **effects_UNSTABLE: [petsistAtom]** 을 추가해준다.  


```typescript
export const accessTokenState = atom<string | null>({
    key: "accessToken",
    default: null,
    effects_UNSTABLE: [persistAtom],
});

export const refreshTokenState = atom<string | null>({
    key: "refreshToken",
    default: null,
    effects_UNSTABLE: [persistAtom],
});
```





## Reference

-   [npm recoil-persist](https://www.npmjs.com/package/recoil-persist)
